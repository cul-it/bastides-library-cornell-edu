<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

    <!-- Mobile viewport optimization h5bp.com/ad -->
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    
    <!-- Internet Explorer use the highest version available -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- Mobile IE allows us to activate ClearType technology for smoothing fonts for easy reading -->
    <!--[if IEMobile]>
      <meta http-equiv="cleartype" content="on">
    <![endif]-->

    <title><%= render_page_title %></title>
    <%= opensearch_description_tag application_name, opensearch_catalog_url(:format => 'xml') %>
    <%= favicon_link_tag 'favicon.png' %>
    <%= stylesheet_link_tag "application", media: "all" %>
    <%= javascript_include_tag "application" %>
    <%= csrf_meta_tags %>
    <%= content_for(:head) %>

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

  </head>
  <%# TODO: this isn't working %>
  <% if current_page?('/') %>
    <body class="<%= render_body_class %> blacklight-home">
  <% else %>
    <body class="<%= render_body_class %>">
  <% end %>
  <%= render :partial => 'shared/header_navbar' %>

  <%= render partial: 'shared/ajax_modal' %>

  <div id="main-container" class="container">
    <%= content_tag :h1, application_name, class: 'sr-only application-heading' %>

    <%= render :partial=>'/flash_msg', layout: 'shared/flash_messages' %>

    <%= yield %>
  </div>

  <%= render :partial => 'shared/footer' %>
  </body>


  <%# slideout sidebar %>
  <script>
    $.asm = {};
    $.asm.panels = 1;

    function sidebar(panels) {
        $.asm.panels = panels;
          if (panels === 1) {
            $('#sidebar').animate({
                  right: -300,
            });
          } else if (panels === 2) {
              $('#sidebar').animate({
                  right: 0,
              });
          $('#mapCanvas').width($('#mapCanvas').parent().width());
          $('#mapCanvas').height($(window).height() - 50);
          // $('#sidebar').height($(window).height() - 50);
          return google.maps.event.trigger($.asm.theMap, 'resize');
          }
        };

        $('#toggleSidebar').click(function() {
          if ($.asm.panels === 1) {
            $('#toggleSidebar i').addClass('fa-minus');
            $('#toggleSidebar i').removeClass('fa-plus');
            return sidebar(2);
          } else {
            $('#toggleSidebar i').removeClass('fa-minus');
            $('#toggleSidebar i').addClass('fa-plus');
            return sidebar(1);
          }
        });
  </script>
</html>
